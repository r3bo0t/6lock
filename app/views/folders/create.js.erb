<% if @folder.valid? %>
  var content = '<p>
                   <%= @folder.name %>
                   <%= link_to 'Destroy', @folder, :data => { :confirm => 'Are you sure?' }, :method => :delete, :remote => true, :class => 'delete_folder' %>
                   <p>
                   <strong>New record</strong>
                   <%= form_for @record, :remote => true do |f| %>
                     <%= hidden_field_tag 'folder_id', @folder.id, :id => nil, :class => 'folder_id' %>
                     <%= f.label :name %>
                     <%= f.text_field :name, :id => nil, :class => 'record_name' %>
                     <%= f.submit %>
                   <% end %>
                   </p>
                 </p>'
  $(function() {
    $('#folder_name').val('')
    $('#folders').prepend(content)
    $('.delete_folder').bind('ajax:success', function() {
      $(this).parent().remove()
    })
  })
<% else %>
  alert("Invalid name")
<% end %>
